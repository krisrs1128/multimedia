---
title: "Template for Joy Data Analysis"
output: rmdformats::readthedown
css: custom.css
vignette: >
  %\VignetteIndexEntry{joy}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE, 
  warning = FALSE, 
  message = FALSE, 
  comment = "#>",
  dev.args = list(bg = "transparent")
)

#knitr::knit_hooks$set(output = multimedia::ansi_aware_handler)
options(crayon.enabled = TRUE)
```

```{r setup}
source("load.R")
library(tidyverse)
library(ggraph)

exper <- demo_joy()
exper
```

### Specification

```{r}
model <- multimedia(
  exper,
  outcomes = "PHQ",
  treatments = "treatment",
  mediators = starts_with("ASV")
)

model
```

```{r}
ggraph(model@edges) +
  geom_edge_link(arrow = arrow()) +
  geom_node_label(aes(label = name, fill = node_type))
```

### Estimation

```{r}
model <- estimate(model, exper)
model@outcome@estimates
model@mediation@estimates
```

### Effects