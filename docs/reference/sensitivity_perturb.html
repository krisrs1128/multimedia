<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Sensitivity to User-Specified Perturbations — sensitivity_perturb • multimedia</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sensitivity to User-Specified Perturbations — sensitivity_perturb"><meta name="description" content="The more standard sensitivity and sensitivity_pathwise functions support
sensitivity analysis to violations in assumptions restricted to specific
mediator-outcome pairs. For more general violations, this function allows
arbitrary modification of the default, diagonal covariance matrix structure
across both mediators and outcomes. This makes it possible to ask what
happens when mediators are correlated with one another or when more some
pairs of mediator-outcome pairs have much stronger correlation than others."><meta property="og:description" content="The more standard sensitivity and sensitivity_pathwise functions support
sensitivity analysis to violations in assumptions restricted to specific
mediator-outcome pairs. For more general violations, this function allows
arbitrary modification of the default, diagonal covariance matrix structure
across both mediators and outcomes. This makes it possible to ask what
happens when mediators are correlated with one another or when more some
pairs of mediator-outcome pairs have much stronger correlation than others."><meta property="og:image" content="https://krisrs1128.github.io/multimedia/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multimedia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/IBD.html">Microbiome - Metabolome Mediation Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/illustration.html">Illustration with Nonlinear Effects</a></li>
    <li><a class="dropdown-item" href="../articles/mindfulness.html">The Mindfulness Study</a></li>
    <li><a class="dropdown-item" href="../articles/random.html">Quick Start with Random Data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/krisrs1128/multimedia/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sensitivity to User-Specified Perturbations</h1>
      <small class="dont-index">Source: <a href="https://github.com/krisrs1128/multimedia/blob/HEAD/R/sensitivity.R" class="external-link"><code>R/sensitivity.R</code></a></small>
      <div class="d-none name"><code>sensitivity_perturb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The more standard sensitivity and sensitivity_pathwise functions support
sensitivity analysis to violations in assumptions restricted to specific
mediator-outcome pairs. For more general violations, this function allows
arbitrary modification of the default, diagonal covariance matrix structure
across both mediators and outcomes. This makes it possible to ask what
happens when mediators are correlated with one another or when more some
pairs of mediator-outcome pairs have much stronger correlation than others.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sensitivity_perturb</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">exper</span>,</span>
<span>  <span class="va">perturb</span>,</span>
<span>  nu_seq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_bootstrap <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A <code>multimedia</code> object containing the fitted models for
sensitivity analysis. Note that since our approach relies on correlating
simulated residual error, it is only applicable to models of class
<code><a href="lm_model.html">lm_model()</a></code>, <code><a href="glmnet_model.html">glmnet_model()</a></code> and <code><a href="rf_model.html">rf_model()</a></code>.</p></dd>


<dt id="arg-exper">exper<a class="anchor" aria-label="anchor" href="#arg-exper"></a></dt>
<dd><p>The original <code>mediation_data</code> class object used to fit <code>model</code>.
These observations will be resampled to support bootstrap confidence
interval construction of the sensitivity curve.</p></dd>


<dt id="arg-perturb">perturb<a class="anchor" aria-label="anchor" href="#arg-perturb"></a></dt>
<dd><p>A matrix towards which the original mediator-outcome
covariance should be perturbed. Must have dimension (n_mediators +
n_outcomes) x (n_mediators + n_outcomes).</p></dd>


<dt id="arg-nu-seq">nu_seq<a class="anchor" aria-label="anchor" href="#arg-nu-seq"></a></dt>
<dd><p>The strength of the perturbation towards the matrix perturb.</p></dd>


<dt id="arg-n-bootstrap">n_bootstrap<a class="anchor" aria-label="anchor" href="#arg-n-bootstrap"></a></dt>
<dd><p>The number of bootstrap resamples used to build confidence
bands around the sensitivity curves. Defaults to 100.</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>A logical indicating whether to show a progress bar.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>date.frame</code> giving the outputs of <code>indirect_overall</code> across many
values of the correlation rho.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Specifically, it defines a new covariance matrix across mediators and
outcomes according to diag(sigma^2_mediator, sigma^2_outcome) + nu * perturb.
The estimates sigma^2 are taken from the residuals in the original mediation
and outcome models, and perturb and nu are provided by the user.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">xy_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="demo_spline.html">demo_spline</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">exper</span> <span class="op">&lt;-</span> <span class="fu"><a href="mediation_data.html">mediation_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">xy_data</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"outcome"</span><span class="op">)</span>, <span class="st">"treatment"</span>, <span class="st">"mediator"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="multimedia.html">multimedia</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">exper</span>,</span></span>
<span class="r-in"><span>    outcome_estimator <span class="op">=</span> <span class="fu"><a href="glmnet_model.html">glmnet_model</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">1e-2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="estimate.html">estimate</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rho_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">perturb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>        <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">sensitivity_perturb</span><span class="op">(</span><span class="va">model</span>, <span class="va">exper</span>, <span class="va">perturb</span>, n_bootstrap <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 24 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   outcome, direct_setting, contrast [4]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        nu outcome direct_setting contrast indirect_effect indirect_effect_stan…¹</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">1</span> <span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span> outcom… 0              0 - 1             -<span style="color: #BB0000;">0.140</span>                0.002<span style="text-decoration: underline;">65</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">6</span> <span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> outcom… 0              0 - 1             -<span style="color: #BB0000;">0.234</span>                0.029<span style="text-decoration: underline;">3</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">2</span> <span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> outcom… 0              0 - 1             -<span style="color: #BB0000;">0.279</span>                0.006<span style="text-decoration: underline;">02</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  2.<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> outcom… 0              0 - 1             -<span style="color: #BB0000;">0.312</span>                0.004<span style="text-decoration: underline;">12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>  6 <span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> outcom… 0              0 - 1             -<span style="color: #BB0000;">0.363</span>                0.010<span style="text-decoration: underline;">6</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  1 <span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span> outcom… 0              0 - 1             -<span style="color: #BB0000;">0.422</span>                0.007<span style="text-decoration: underline;">04</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">1</span> <span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span> outcom… 1              0 - 1             -<span style="color: #BB0000;">0.140</span>                0.002<span style="text-decoration: underline;">65</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">6</span> <span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> outcom… 1              0 - 1             -<span style="color: #BB0000;">0.234</span>                0.029<span style="text-decoration: underline;">3</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">2</span> <span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> outcom… 1              0 - 1             -<span style="color: #BB0000;">0.279</span>                0.006<span style="text-decoration: underline;">02</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>  2.<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> outcom… 1              0 - 1             -<span style="color: #BB0000;">0.312</span>                0.004<span style="text-decoration: underline;">12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 14 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ abbreviated name: ¹​indirect_effect_standard_error</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kris Sankaran, Hanying Jiang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

