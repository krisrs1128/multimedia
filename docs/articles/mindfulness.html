<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The Mindfulness Study • multimedia</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The Mindfulness Study">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multimedia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/IBD.html">Microbiome - Metabolome Mediation Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/illustration.html">Illustration with Nonlinear Effects</a></li>
    <li><a class="dropdown-item" href="../articles/mindfulness.html">The Mindfulness Study</a></li>
    <li><a class="dropdown-item" href="../articles/random.html">Quick Start with Random Data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/krisrs1128/multimedia/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>The Mindfulness Study</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/krisrs1128/multimedia/blob/HEAD/vignettes/mindfulness.Rmd" class="external-link"><code>vignettes/mindfulness.Rmd</code></a></small>
      <div class="d-none name"><code>mindfulness.Rmd</code></div>
    </div>

    
    
<p>In most microbiome mediation analysis studies, microbiome composition
is thought to mediate some outcome of interest. Sometimes, though, we
might want to treat the microbiome as an outcome. Our motivating example
here looks at the relationship between mindfulness and the microbiome.
In this setting, we might imagine that mindfulness training influences
behaviors (diet, sleep, exercise) that could then change the microbiome.
Clinical surveys that gauge those behaviors now play the role of
mediator. Alternatively, mindfulness could trigger neurophysiological
changes that influence the microbiome in more subtle ways. The point of
mediation analysis is to provide evidence for one or the other of these
possibilities.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/" class="external-link">ggdist</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/" class="external-link">ggrepel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217" class="external-link">phyloseq</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://krisrs1128.github.io/multimedia/">multimedia</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mindfulness</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20231228</span><span class="op">)</span></span></code></pre></div>
<p>This package needs a <code>mediation_data</code> object to organize
the pretreatment, treatment, mediator, and outcome variables.
<code>taxa_names(mindfulness)</code> specifies that we want all the taxa
names to be outcome variables. We’ve already appended all the mediator
variable names with the prefix “mediator,” so we can specify them using
the <code>starts_with</code> selector. We’ll treat the
<code>subject</code> column as pretreatment variables. The study tracked
participants across a few timepoints, and we want to control for
different baseline behavioral and microbiome profiles.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exper</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mediation_data.html">mediation_data</a></span><span class="op">(</span></span>
<span>    <span class="va">mindfulness</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html" class="external-link">taxa_names</a></span><span class="op">(</span><span class="va">mindfulness</span><span class="op">)</span>,</span>
<span>    <span class="st">"treatment"</span>,</span>
<span>    <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"mediator"</span><span class="op">)</span>,</span>
<span>    <span class="st">"subject"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">exper</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; [Mediation Data] </span></span>
<span><span class="co">#&gt; 307 samples with measurements for, </span></span>
<span><span class="co">#&gt; 1 treatment: treatment </span></span>
<span><span class="co">#&gt; 4 mediators: mediator.sleepDistRaw, mediator.fatigueRaw, ... </span></span>
<span><span class="co">#&gt; 55 outcomes: Defluviitalea, Gordonibacter, ... </span></span>
<span><span class="co">#&gt; 1 pretreatment: subject</span></span></code></pre>
<p>This block applies a logistic-normal multinomial model to the
microbiome outcome. This is an example where the response variables are
all modeled jointly. We’ll use a ridge regression model for each of the
mediators. This is a better choice than ordinary linear models because
we have to estimate many subject-level parameters, and our sample size
is not that large.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use Flavonifractor as the reference for the log-ratio transform</span></span>
<span><span class="fu"><a href="../reference/outcomes.html">outcomes</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/outcomes.html">outcomes</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Flavonifractor</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multimedia.html">multimedia</a></span><span class="op">(</span></span>
<span>    <span class="va">exper</span>,</span>
<span>    <span class="fu"><a href="../reference/lnm_model.html">lnm_model</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="va">.Random.seed</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/glmnet_model.html">glmnet_model</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">#&gt; Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">#&gt; Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 0.01147 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 114.7 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">#&gt; Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">#&gt; Chain 1:    100      -243307.612             1.000            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    200       -99580.409             1.222            1.443</span></span>
<span><span class="co">#&gt; Chain 1:    300       -90008.408             0.850            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    400       -87376.289             0.645            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    500       -85962.756             0.519            0.106</span></span>
<span><span class="co">#&gt; Chain 1:    600       -85132.538             0.434            0.106</span></span>
<span><span class="co">#&gt; Chain 1:    700       -84674.011             0.373            0.030</span></span>
<span><span class="co">#&gt; Chain 1:    800       -84249.244             0.327            0.030</span></span>
<span><span class="co">#&gt; Chain 1:    900       -84035.521             0.291            0.016</span></span>
<span><span class="co">#&gt; Chain 1:   1000       -83782.160             0.262            0.016</span></span>
<span><span class="co">#&gt; Chain 1:   1100       -83487.854             0.163            0.010   MEDIAN ELBO CONVERGED</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Drawing a sample of size 1000 from the approximate posterior... </span></span>
<span><span class="co">#&gt; Chain 1: COMPLETED.</span></span></code></pre>
<div class="section level2">
<h2 id="evaluating-effects">Evaluating Effects<a class="anchor" aria-label="anchor" href="#evaluating-effects"></a>
</h2>
<p>With this model, we can estimate direct and indirect effects. We’re
averaging over different settings of the mediator treatment variables.
Since the LNM model outputs relative abundance profiles, all the
estimated effects should be interpreted on a probability scale.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/direct_effect.html">direct_effect</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">exper</span><span class="op">)</span></span>
<span><span class="va">direct</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>direct_effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">direct_effect</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">direct_effect</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; # A tibble: 55 × 2</span></span>
<span><span class="co">#&gt;    outcome          direct_effect</span></span>
<span><span class="co">#&gt;                        </span></span>
<span><span class="co">#&gt;  1 Blautia               -0.0597 </span></span>
<span><span class="co">#&gt;  2 Faecalibacterium      -0.0315 </span></span>
<span><span class="co">#&gt;  3 Bifidobacterium        0.0146 </span></span>
<span><span class="co">#&gt;  4 Prevotella             0.00965</span></span>
<span><span class="co">#&gt;  5 Clostridium_XlVa       0.00711</span></span>
<span><span class="co">#&gt;  6 Ruminococcus           0.00695</span></span>
<span><span class="co">#&gt;  7 Dorea                  0.00677</span></span>
<span><span class="co">#&gt;  8 Clostridium_IV        -0.00613</span></span>
<span><span class="co">#&gt;  9 Roseburia             -0.00488</span></span>
<span><span class="co">#&gt; 10 Oscillibacter          0.00480</span></span>
<span><span class="co">#&gt; # ℹ 45 more rows</span></span></code></pre>
<p>These are the indirect effects when we set mediators to the treatment
setting one at a time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indirect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/indirect_pathwise.html">indirect_pathwise</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">exper</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">mediator</span>, <span class="va">outcome</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>indirect_effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">indirect_effect</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">indirect_effect</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">indirect</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; # A tibble: 220 × 3</span></span>
<span><span class="co">#&gt; # Groups:   mediator [4]</span></span>
<span><span class="co">#&gt;    mediator                    outcome          indirect_effect</span></span>
<span><span class="co">#&gt;                                                 </span></span>
<span><span class="co">#&gt;  1 mediator.Fruit..not.juices. Faecalibacterium         0.00813</span></span>
<span><span class="co">#&gt;  2 mediator.sleepDistRaw       Faecalibacterium        -0.00810</span></span>
<span><span class="co">#&gt;  3 mediator.sleepDistRaw       Roseburia               -0.00710</span></span>
<span><span class="co">#&gt;  4 mediator.fatigueRaw         Blautia                 -0.00683</span></span>
<span><span class="co">#&gt;  5 mediator.fatigueRaw         Faecalibacterium         0.00547</span></span>
<span><span class="co">#&gt;  6 mediator.fatigueRaw         Roseburia                0.00467</span></span>
<span><span class="co">#&gt;  7 mediator.Fruit..not.juices. Ruminococcus             0.00354</span></span>
<span><span class="co">#&gt;  8 mediator.sleepDistRaw       Blautia                  0.00301</span></span>
<span><span class="co">#&gt;  9 mediator.Cold.cereal        Blautia                  0.00216</span></span>
<span><span class="co">#&gt; 10 mediator.Fruit..not.juices. Blautia                  0.00210</span></span>
<span><span class="co">#&gt; # ℹ 210 more rows</span></span></code></pre>
<p><code>plot_mediators</code> visualizes the relationship between
mediator and outcome variables. The title for each subplot is the
estimated indirect effect (note that it’s <code>Control</code> -
<code>Treatment</code> in the current definition). For example, in the
panel relating sleep disturbances and Blautia, there is a rough positive
association between these variables. The control group has a higher
number of sleep disturbances, which is translated into a positive
indirect effect for this pair. The model accounts for more than these
pairwise relationships, though – it controls for subject-level baselines
and includes direct effects of treatment – so these figures should be
interpreted within the larger model context.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exper_rela</span> <span class="op">&lt;-</span> <span class="va">exper</span></span>
<span><span class="fu"><a href="../reference/outcomes.html">outcomes</a></span><span class="op">(</span><span class="va">exper_rela</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/compositions/man/normalize.html" class="external-link">normalize</a></span><span class="op">(</span><span class="fu"><a href="../reference/outcomes.html">outcomes</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_mediators.html">plot_mediators</a></span><span class="op">(</span><span class="va">indirect</span>, <span class="va">exper_rela</span><span class="op">)</span></span></code></pre></div>
<p><img src="mindfulness_files/figure-html/mediator_plot-1.png" width="600" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="model-alterations">Model Alterations<a class="anchor" aria-label="anchor" href="#model-alterations"></a>
</h2>
<p>Hypothesis testing is built on the idea that a simple submodel might
explain the data just as well as a full, more complicated one. In
mediation analysis, we can zero out sets of edges to define submodels.
For example, we can re-estimate a model that does not allow any
relationship between the treatment and the mediators.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">altered</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/nullify.html">nullify</a></span><span class="op">(</span><span class="st">"T-&gt;M"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">#&gt; Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">#&gt; Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 0.009343 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 93.43 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">#&gt; Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">#&gt; Chain 1:    100      -243307.612             1.000            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    200       -99580.409             1.222            1.443</span></span>
<span><span class="co">#&gt; Chain 1:    300       -90008.408             0.850            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    400       -87376.289             0.645            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    500       -85962.756             0.519            0.106</span></span>
<span><span class="co">#&gt; Chain 1:    600       -85132.538             0.434            0.106</span></span>
<span><span class="co">#&gt; Chain 1:    700       -84674.011             0.373            0.030</span></span>
<span><span class="co">#&gt; Chain 1:    800       -84249.244             0.327            0.030</span></span>
<span><span class="co">#&gt; Chain 1:    900       -84035.521             0.291            0.016</span></span>
<span><span class="co">#&gt; Chain 1:   1000       -83782.160             0.262            0.016</span></span>
<span><span class="co">#&gt; Chain 1:   1100       -83487.854             0.163            0.010   MEDIAN ELBO CONVERGED</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Drawing a sample of size 1000 from the approximate posterior... </span></span>
<span><span class="co">#&gt; Chain 1: COMPLETED.</span></span></code></pre>
<p>These modified models can be used to simulate synthetic null data
that help contextualize the effects seen in real data. For example, we
can compare imaginary cohort drawn from the original and the altered
models. Notice that I re-assigned all the treatments. This removes
potential confounding between the treatment and subject level effects –
this effect doesn’t exist on average across the population because the
study was randomized, but we want to remove any associations present in
our finite sample.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_assign</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/treatments.html">treatments</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="../reference/treatments.html">treatments</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span><span class="va">profile</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setup_profile.html">setup_profile</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">new_assign</span>, <span class="va">new_assign</span><span class="op">)</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">model</span>, profile <span class="op">=</span> <span class="va">profile</span>, pretreatment <span class="op">=</span> <span class="fu"><a href="../reference/pretreatments.html">pretreatments</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">altered</span>, profile <span class="op">=</span> <span class="va">profile</span>, pretreatment <span class="op">=</span> <span class="fu"><a href="../reference/pretreatments.html">pretreatments</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The sampled objects above have the same class as <code>exper</code>.
We can extract the real and simulated mediator data to see the treatment
effects along those edges. As expected, the altered model has no
systematic difference between treatment groups. This lends some evidence
to the conclusion that mindfulness does influence the mediators, which
was implicit in our discussion of indirect effects above.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    real <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="fu"><a href="../reference/treatments.html">treatments</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span>, <span class="fu"><a href="../reference/mediators.html">mediators</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span>, <span class="fu"><a href="../reference/pretreatments.html">pretreatments</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    original <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="va">new_assign</span>, <span class="fu"><a href="../reference/mediators.html">mediators</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>, <span class="fu"><a href="../reference/pretreatments.html">pretreatments</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    altered <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="va">new_assign</span>, <span class="fu"><a href="../reference/mediators.html">mediators</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span>, <span class="fu"><a href="../reference/pretreatments.html">pretreatments</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"source"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"mediator"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"mediator"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">value</span>, <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">mediator</span>, <span class="va">value</span>, <span class="va">median</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">source</span><span class="op">)</span></span></code></pre></div>
<p><img src="mindfulness_files/figure-html/synthetic_mediation_plot-1.png" width="600" style="display: block; margin: auto;"></p>
<p>Here is the analogous alteration that removes all direct effects. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-axis
is on a log scale, and the LNM’s estimated treatment effects for rare
taxa are not practically significant. It’s interesting that even though
the original data don’t show much difference between treatment groups,
the model suggests that there are real effects, even for the abundant
taxa. It’s possible that, in the raw boxplots, heterogeneity across
subjects and mediators masks true effects, and the LNM is able to detect
these effects by appropriately accounting for sources of
heterogeneity.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">altered_direct</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/nullify.html">nullify</a></span><span class="op">(</span><span class="st">"T-&gt;Y"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">#&gt; Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">#&gt; Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 0.008824 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 88.24 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">#&gt; Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">#&gt; Chain 1:    100      -286918.019             1.000            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    200      -104917.320             1.367            1.735</span></span>
<span><span class="co">#&gt; Chain 1:    300       -92595.460             0.956            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    400       -88954.112             0.727            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    500       -87383.372             0.585            0.133</span></span>
<span><span class="co">#&gt; Chain 1:    600       -86258.965             0.490            0.133</span></span>
<span><span class="co">#&gt; Chain 1:    700       -85569.685             0.421            0.041</span></span>
<span><span class="co">#&gt; Chain 1:    800       -84971.656             0.369            0.041</span></span>
<span><span class="co">#&gt; Chain 1:    900       -84708.412             0.329            0.018</span></span>
<span><span class="co">#&gt; Chain 1:   1000       -84309.170             0.296            0.018</span></span>
<span><span class="co">#&gt; Chain 1:   1100       -84071.410             0.197            0.013</span></span>
<span><span class="co">#&gt; Chain 1:   1200       -83880.348             0.023            0.008   MEDIAN ELBO CONVERGED</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Drawing a sample of size 1000 from the approximate posterior... </span></span>
<span><span class="co">#&gt; Chain 1: COMPLETED.</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">altered_indirect</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/nullify.html">nullify</a></span><span class="op">(</span><span class="st">"M-&gt;Y"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">#&gt; Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">#&gt; Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 0.005422 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 54.22 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">#&gt; Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">#&gt; Chain 1:    100      -266185.924             1.000            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    200      -103322.121             1.288            1.576</span></span>
<span><span class="co">#&gt; Chain 1:    300       -90720.935             0.905            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    400       -87659.862             0.688            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    500       -86393.749             0.553            0.139</span></span>
<span><span class="co">#&gt; Chain 1:    600       -85556.774             0.462            0.139</span></span>
<span><span class="co">#&gt; Chain 1:    700       -84583.951             0.398            0.035</span></span>
<span><span class="co">#&gt; Chain 1:    800       -84086.834             0.349            0.035</span></span>
<span><span class="co">#&gt; Chain 1:    900       -83825.808             0.311            0.015</span></span>
<span><span class="co">#&gt; Chain 1:   1000       -83560.389             0.280            0.015</span></span>
<span><span class="co">#&gt; Chain 1:   1100       -83420.529             0.180            0.012</span></span>
<span><span class="co">#&gt; Chain 1:   1200       -83137.414             0.023            0.010   MEDIAN ELBO CONVERGED</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Drawing a sample of size 1000 from the approximate posterior... </span></span>
<span><span class="co">#&gt; Chain 1: COMPLETED.</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">profile</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setup_profile.html">setup_profile</a></span><span class="op">(</span><span class="va">model</span>, <span class="fu"><a href="../reference/treatments.html">treatments</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span>, <span class="fu"><a href="../reference/treatments.html">treatments</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">model</span>, profile <span class="op">=</span> <span class="va">profile</span>, pretreatment <span class="op">=</span> <span class="fu"><a href="../reference/pretreatments.html">pretreatments</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span>
<span>    <span class="va">altered_direct</span>,</span>
<span>    profile <span class="op">=</span> <span class="va">profile</span>, pretreatment <span class="op">=</span> <span class="fu"><a href="../reference/pretreatments.html">pretreatments</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">y3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span>
<span>    <span class="va">altered_indirect</span>,</span>
<span>    profile <span class="op">=</span> <span class="va">profile</span>, pretreatment <span class="op">=</span> <span class="fu"><a href="../reference/pretreatments.html">pretreatments</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">taxa_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/compositions/man/normalize.html" class="external-link">normalize</a></span><span class="op">(</span><span class="fu"><a href="../reference/outcomes.html">outcomes</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fl">2</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.infinite</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Original Data"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/compositions/man/normalize.html" class="external-link">normalize</a></span><span class="op">(</span><span class="fu"><a href="../reference/outcomes.html">outcomes</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"Full Model"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/compositions/man/normalize.html" class="external-link">normalize</a></span><span class="op">(</span><span class="fu"><a href="../reference/outcomes.html">outcomes</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"No Direct Effect"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/compositions/man/normalize.html" class="external-link">normalize</a></span><span class="op">(</span><span class="fu"><a href="../reference/outcomes.html">outcomes</a></span><span class="op">(</span><span class="va">y2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"No Indirect Effect"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/compositions/man/normalize.html" class="external-link">normalize</a></span><span class="op">(</span><span class="fu"><a href="../reference/outcomes.html">outcomes</a></span><span class="op">(</span><span class="va">y3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"source"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="../reference/treatments.html">treatments</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">$</span><span class="va">treatment</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu"><a href="../reference/outcomes.html">outcomes</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">name</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu"><a href="../reference/outcomes.html">outcomes</a></span><span class="op">(</span><span class="va">exper</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">taxa_order</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">combined_samples</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, <span class="va">name</span>, fill <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span>,</span>
<span>        size <span class="op">=</span> <span class="fl">0.4</span>, outlier.size <span class="op">=</span> <span class="fl">0.8</span>, position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fl">0.7</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"log(Relative Abundance)"</span>, y <span class="op">=</span> <span class="st">"Genus"</span>, fill <span class="op">=</span> <span class="st">""</span>, col <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">source</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="mindfulness_files/figure-html/alteration_plot-1.png" width="600" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined_samples</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">source</span>, <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>presence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">presence</span>, <span class="va">name</span>, fill <span class="op">=</span> <span class="va">treatment</span>, col <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span>,</span>
<span>        position <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fl">0.7</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">source</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="mindfulness_files/figure-html/alteration_presence-1.png" width="600" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="synthetic-null-testing">Synthetic Null Testing<a class="anchor" aria-label="anchor" href="#synthetic-null-testing"></a>
</h2>
<p>A standard approach to inference is to apply a bootstrap (this is
done at the end of the vignette). An alternative, which is less common,
but well-suited to high-dimensions is to calibrate variable selection
sets using synthetic null data. For example, this is the intuition
behind the knockoff, Clipper, and mirror statistic algorithms. The
general recipe is:</p>
<ol style="list-style-type: decimal">
<li>Simulate synthetic null data from a model/sampling mechanism where
we know for certain that an effect does not exist.</li>
<li>Use the full model to estimate effects on this synthetic null
data.</li>
<li>Define a selection rule so that the fraction of selected synthetic
null effects is kept below an false discovery rate threshold.</li>
</ol>
<p>The synthetic null effects essentially serve as negative controls to
calibrate inference.</p>
<p>In <code>multimedia</code>, <code>null_contrast</code> estimates
effects on real and synthetic null data, while <code>fdr_summary</code>
ranks and selects features. Each point in the figure below is the
directed effect for a single feature in either real or synthetic data.
We rank features according to their absolute effect size, and as soon as
negative control features enter, we begin increasing the estimated false
discovery rate for the rule that selects features up to that point.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/null_contrast.html">null_contrast</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">exper</span>, <span class="st">"T-&gt;Y"</span>, <span class="va">direct_effect</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">#&gt; Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">#&gt; Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 0.009401 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 94.01 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">#&gt; Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">#&gt; Chain 1:    100      -286918.019             1.000            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    200      -104917.320             1.367            1.735</span></span>
<span><span class="co">#&gt; Chain 1:    300       -92595.460             0.956            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    400       -88954.112             0.727            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    500       -87383.372             0.585            0.133</span></span>
<span><span class="co">#&gt; Chain 1:    600       -86258.965             0.490            0.133</span></span>
<span><span class="co">#&gt; Chain 1:    700       -85569.685             0.421            0.041</span></span>
<span><span class="co">#&gt; Chain 1:    800       -84971.656             0.369            0.041</span></span>
<span><span class="co">#&gt; Chain 1:    900       -84708.412             0.329            0.018</span></span>
<span><span class="co">#&gt; Chain 1:   1000       -84309.170             0.296            0.018</span></span>
<span><span class="co">#&gt; Chain 1:   1100       -84071.410             0.197            0.013</span></span>
<span><span class="co">#&gt; Chain 1:   1200       -83880.348             0.023            0.008   MEDIAN ELBO CONVERGED</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Drawing a sample of size 1000 from the approximate posterior... </span></span>
<span><span class="co">#&gt; Chain 1: COMPLETED.</span></span>
<span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">#&gt; Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">#&gt; Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 0.010767 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 107.67 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">#&gt; Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">#&gt; Chain 1:    100      -391735.619             1.000            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    200      -123084.368             1.591            2.183</span></span>
<span><span class="co">#&gt; Chain 1:    300      -103754.600             1.123            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    400       -99814.204             0.852            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    500       -98004.299             0.685            0.186</span></span>
<span><span class="co">#&gt; Chain 1:    600       -97186.482             0.573            0.186</span></span>
<span><span class="co">#&gt; Chain 1:    700       -95876.610             0.493            0.039</span></span>
<span><span class="co">#&gt; Chain 1:    800       -95453.577             0.432            0.039</span></span>
<span><span class="co">#&gt; Chain 1:    900       -95047.459             0.384            0.018</span></span>
<span><span class="co">#&gt; Chain 1:   1000       -94765.977             0.346            0.018</span></span>
<span><span class="co">#&gt; Chain 1:   1100       -94364.239             0.246            0.014</span></span>
<span><span class="co">#&gt; Chain 1:   1200       -94015.018             0.029            0.008   MEDIAN ELBO CONVERGED</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Drawing a sample of size 1000 from the approximate posterior... </span></span>
<span><span class="co">#&gt; Chain 1: COMPLETED.</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fdr_direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fdr_summary.html">fdr_summary</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="st">"direct_effect"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>effect <span class="op">=</span> <span class="va">direct_effect</span><span class="op">)</span></span></code></pre></div>
<p>The indirect effect analog is shown below. It seems we have more
evidence for direct than indirect effects. This is consistent with
literature on the difficulty of estimating indirect effects in mediation
analysis.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/null_contrast.html">null_contrast</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">exper</span>, <span class="st">"M-&gt;Y"</span>, <span class="va">indirect_overall</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">#&gt; Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">#&gt; Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 0.009353 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 93.53 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">#&gt; Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">#&gt; Chain 1:    100      -266185.924             1.000            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    200      -103322.121             1.288            1.576</span></span>
<span><span class="co">#&gt; Chain 1:    300       -90720.935             0.905            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    400       -87659.862             0.688            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    500       -86393.749             0.553            0.139</span></span>
<span><span class="co">#&gt; Chain 1:    600       -85556.774             0.462            0.139</span></span>
<span><span class="co">#&gt; Chain 1:    700       -84583.951             0.398            0.035</span></span>
<span><span class="co">#&gt; Chain 1:    800       -84086.834             0.349            0.035</span></span>
<span><span class="co">#&gt; Chain 1:    900       -83825.808             0.311            0.015</span></span>
<span><span class="co">#&gt; Chain 1:   1000       -83560.389             0.280            0.015</span></span>
<span><span class="co">#&gt; Chain 1:   1100       -83420.529             0.180            0.012</span></span>
<span><span class="co">#&gt; Chain 1:   1200       -83137.414             0.023            0.010   MEDIAN ELBO CONVERGED</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Drawing a sample of size 1000 from the approximate posterior... </span></span>
<span><span class="co">#&gt; Chain 1: COMPLETED.</span></span>
<span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">#&gt; Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">#&gt; Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 0.009819 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 98.19 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">#&gt; Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">#&gt; Chain 1:    100      -536911.514             1.000            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    200      -150652.982             1.782            2.564</span></span>
<span><span class="co">#&gt; Chain 1:    300      -108404.395             1.318            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    400       -99598.698             1.011            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    500       -97233.667             0.813            0.390</span></span>
<span><span class="co">#&gt; Chain 1:    600       -96170.474             0.680            0.390</span></span>
<span><span class="co">#&gt; Chain 1:    700       -95057.572             0.584            0.088</span></span>
<span><span class="co">#&gt; Chain 1:    800       -94459.759             0.512            0.088</span></span>
<span><span class="co">#&gt; Chain 1:    900       -94129.598             0.455            0.024</span></span>
<span><span class="co">#&gt; Chain 1:   1000       -93808.753             0.410            0.024</span></span>
<span><span class="co">#&gt; Chain 1:   1100       -93521.922             0.311            0.012</span></span>
<span><span class="co">#&gt; Chain 1:   1200       -93119.189             0.055            0.011</span></span>
<span><span class="co">#&gt; Chain 1:   1300       -92965.159             0.016            0.006   MEDIAN ELBO CONVERGED</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Drawing a sample of size 1000 from the approximate posterior... </span></span>
<span><span class="co">#&gt; Chain 1: COMPLETED.</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fdr_indirect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fdr_summary.html">fdr_summary</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="st">"indirect_overall"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>effect <span class="op">=</span> <span class="va">indirect_effect</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fdr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">fdr_direct</span>, <span class="va">fdr_indirect</span>, .id <span class="op">=</span> <span class="st">"effect_type"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>effect_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Direct"</span>, <span class="st">"Indirect"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">effect_type</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">fdr_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">effect</span>, <span class="va">fdr_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fdr_data</span>, <span class="va">keep</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">outcome</span>, col <span class="op">=</span> <span class="va">source</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, force <span class="op">=</span> <span class="fl">10</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Effect"</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">widehat</span><span class="op">(</span><span class="va">FDR</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"Data Source"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">source</span>, size <span class="op">=</span> <span class="va">keep</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_discrete</a></span><span class="op">(</span><span class="st">"Selected"</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">3</span><span class="op">)</span>, guide <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.55</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">effect_type</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p><img src="mindfulness_files/figure-html/contrast_plot-1.png" width="600" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bind_mediation.html">bind_mediation</a></span><span class="op">(</span><span class="va">exper_rela</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>        <span class="va">subject</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"mediator"</span><span class="op">)</span>, <span class="va">treatment</span>, <span class="va">Roseburia</span>, <span class="va">Blautia</span>,</span>
<span>        <span class="va">Faecalibacterium</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"mediator"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"mediator"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>mediator <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="va">mediator</span>, <span class="st">"mediator."</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>        <span class="va">Roseburia</span><span class="op">:</span><span class="va">Faecalibacterium</span>,</span>
<span>        names_to <span class="op">=</span> <span class="st">"taxon"</span>, values_to <span class="op">=</span> <span class="st">"abundance"</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">subject</span>, <span class="va">mediator</span>, <span class="va">treatment</span>, <span class="va">taxon</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>abundance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">abundance</span><span class="op">)</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">value</span>, <span class="va">abundance</span>, col <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">taxon</span> <span class="op">~</span> <span class="va">mediator</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Relative Abundance"</span>, x <span class="op">=</span> <span class="st">"Mediator Value"</span>, col <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        strip.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span>, angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p><img src="mindfulness_files/figure-html/unnamed-chunk-1-1.png" width="600" style="display: block; margin: auto;"></p>
<p>Here is the analog for indirect pathwise effects. Since these effects
distinguish between individual mediators, we can facet by these
variables.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/null_contrast.html">null_contrast</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">exper</span>, <span class="st">"M-&gt;Y"</span>, <span class="va">indirect_pathwise</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">#&gt; Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">#&gt; Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 0.01009 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 100.9 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">#&gt; Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">#&gt; Chain 1:    100      -266185.924             1.000            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    200      -103322.121             1.288            1.576</span></span>
<span><span class="co">#&gt; Chain 1:    300       -90720.935             0.905            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    400       -87659.862             0.688            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    500       -86393.749             0.553            0.139</span></span>
<span><span class="co">#&gt; Chain 1:    600       -85556.774             0.462            0.139</span></span>
<span><span class="co">#&gt; Chain 1:    700       -84583.951             0.398            0.035</span></span>
<span><span class="co">#&gt; Chain 1:    800       -84086.834             0.349            0.035</span></span>
<span><span class="co">#&gt; Chain 1:    900       -83825.808             0.311            0.015</span></span>
<span><span class="co">#&gt; Chain 1:   1000       -83560.389             0.280            0.015</span></span>
<span><span class="co">#&gt; Chain 1:   1100       -83420.529             0.180            0.012</span></span>
<span><span class="co">#&gt; Chain 1:   1200       -83137.414             0.023            0.010   MEDIAN ELBO CONVERGED</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Drawing a sample of size 1000 from the approximate posterior... </span></span>
<span><span class="co">#&gt; Chain 1: COMPLETED.</span></span>
<span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">#&gt; Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">#&gt; Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">#&gt; Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 0.009596 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 95.96 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">#&gt; Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">#&gt; Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">#&gt; Chain 1:    100      -353418.243             1.000            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    200      -121672.514             1.452            1.905</span></span>
<span><span class="co">#&gt; Chain 1:    300      -103404.304             1.027            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    400       -99247.533             0.781            1.000</span></span>
<span><span class="co">#&gt; Chain 1:    500       -96998.099             0.629            0.177</span></span>
<span><span class="co">#&gt; Chain 1:    600       -95897.177             0.526            0.177</span></span>
<span><span class="co">#&gt; Chain 1:    700       -95178.567             0.452            0.042</span></span>
<span><span class="co">#&gt; Chain 1:    800       -94560.159             0.396            0.042</span></span>
<span><span class="co">#&gt; Chain 1:    900       -93995.043             0.353            0.023</span></span>
<span><span class="co">#&gt; Chain 1:   1000       -93539.235             0.318            0.023</span></span>
<span><span class="co">#&gt; Chain 1:   1100       -93316.396             0.219            0.011</span></span>
<span><span class="co">#&gt; Chain 1:   1200       -93181.743             0.028            0.008   MEDIAN ELBO CONVERGED</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Drawing a sample of size 1000 from the approximate posterior... </span></span>
<span><span class="co">#&gt; Chain 1: COMPLETED.</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fdr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fdr_summary.html">fdr_summary</a></span><span class="op">(</span><span class="va">contrast</span>, <span class="st">"indirect_pathwise"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">fdr</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">indirect_effect</span>, <span class="va">fdr_hat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fdr</span>, <span class="va">keep</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">outcome</span>, fill <span class="op">=</span> <span class="va">source</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">4</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Indirect Effect"</span>, y <span class="op">=</span> <span class="st">"Estimated False Discovery Rate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">source</span>, size <span class="op">=</span> <span class="va">keep</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_discrete</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">mediator</span><span class="op">)</span></span></code></pre></div>
<p><img src="mindfulness_files/figure-html/indirect_pathwise_contrast-1.png" width="600" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="random-forests">Random Forests<a class="anchor" aria-label="anchor" href="#random-forests"></a>
</h2>
<p>The LNM makes relatively strong assumptions on the outcome model: The
effects must enter linearly through a multinomial likelihood. As a
nonparametric alternative, we can fit separate random forest models to
each microbe’s abundance. Since this model doesn’t directly account for
compositions, it will help to transform the response to relative
abundances.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multimedia.html">multimedia</a></span><span class="op">(</span></span>
<span>    <span class="va">exper_rela</span>,</span>
<span>    <span class="fu"><a href="../reference/rf_model.html">rf_model</a></span><span class="op">(</span>num.trees <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/glmnet_model.html">glmnet_model</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/estimate.html">estimate</a></span><span class="op">(</span><span class="va">exper_rela</span><span class="op">)</span></span></code></pre></div>
<p>We can compute direct and indirect effects from the estimated
model.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/direct_effect.html">direct_effect</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">exper_rela</span><span class="op">)</span></span>
<span><span class="va">direct_sorted</span> <span class="op">&lt;-</span> <span class="va">direct</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">outcome</span>, <span class="va">contrast</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>direct_effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">direct_effect</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">direct_effect</span><span class="op">)</span></span>
<span></span>
<span><span class="va">indirect_sorted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/indirect_pathwise.html">indirect_pathwise</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">exper_rela</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">outcome</span>, <span class="va">mediator</span>, <span class="va">contrast</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>indirect_effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">indirect_effect</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">indirect_effect</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">direct_sorted</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; # A tibble: 55 × 3</span></span>
<span><span class="co">#&gt; # Groups:   outcome [55]</span></span>
<span><span class="co">#&gt;    outcome               contrast            direct_effect</span></span>
<span><span class="co">#&gt;                                            </span></span>
<span><span class="co">#&gt;  1 Ruminococcus          Control - Treatment      0.00476 </span></span>
<span><span class="co">#&gt;  2 Faecalibacterium      Control - Treatment      0.00309 </span></span>
<span><span class="co">#&gt;  3 Coprococcus           Control - Treatment      0.00251 </span></span>
<span><span class="co">#&gt;  4 Roseburia             Control - Treatment      0.00243 </span></span>
<span><span class="co">#&gt;  5 Gemmiger              Control - Treatment      0.00109 </span></span>
<span><span class="co">#&gt;  6 Parabacteroides       Control - Treatment      0.00108 </span></span>
<span><span class="co">#&gt;  7 Dorea                 Control - Treatment      0.000857</span></span>
<span><span class="co">#&gt;  8 Streptococcus         Control - Treatment      0.000842</span></span>
<span><span class="co">#&gt;  9 Bacteroides           Control - Treatment      0.000295</span></span>
<span><span class="co">#&gt; 10 Phascolarctobacterium Control - Treatment      0.000210</span></span>
<span><span class="co">#&gt; # ℹ 45 more rows</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indirect_sorted</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; # A tibble: 220 × 4</span></span>
<span><span class="co">#&gt; # Groups:   outcome, mediator [220]</span></span>
<span><span class="co">#&gt;    outcome          mediator                    contrast         indirect_effect</span></span>
<span><span class="co">#&gt;                                                             </span></span>
<span><span class="co">#&gt;  1 Ruminococcus     mediator.Cold.cereal        Control - Treat…        -0.0104 </span></span>
<span><span class="co">#&gt;  2 Blautia          mediator.sleepDistRaw       Control - Treat…         0.00762</span></span>
<span><span class="co">#&gt;  3 Blautia          mediator.Cold.cereal        Control - Treat…         0.00670</span></span>
<span><span class="co">#&gt;  4 Clostridium_IV   mediator.Cold.cereal        Control - Treat…        -0.00627</span></span>
<span><span class="co">#&gt;  5 Prevotella       mediator.Fruit..not.juices. Control - Treat…        -0.00527</span></span>
<span><span class="co">#&gt;  6 Prevotella       mediator.Cold.cereal        Control - Treat…         0.00504</span></span>
<span><span class="co">#&gt;  7 Faecalibacterium mediator.Fruit..not.juices. Control - Treat…         0.00497</span></span>
<span><span class="co">#&gt;  8 Bacteroides      mediator.Cold.cereal        Control - Treat…         0.00453</span></span>
<span><span class="co">#&gt;  9 Ruminococcus     mediator.Fruit..not.juices. Control - Treat…         0.00406</span></span>
<span><span class="co">#&gt; 10 Faecalibacterium mediator.sleepDistRaw       Control - Treat…        -0.00367</span></span>
<span><span class="co">#&gt; # ℹ 210 more rows</span></span></code></pre>
<p>We can visualize some of the features with the largest direct and
indirect effects. Nonlinearity seems to have helped uncover a few
mediator to microbe relationships, for example, the relationships
between sleep disturbance/Ruminococcus2 and cereal/Faecalibacterium.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_mediators.html">plot_mediators</a></span><span class="op">(</span><span class="va">indirect_sorted</span>, <span class="va">exper_rela</span><span class="op">)</span></span></code></pre></div>
<p><img src="mindfulness_files/figure-html/rf_mediation_plots-1.png" width="600" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="bootstrap">Bootstrap<a class="anchor" aria-label="anchor" href="#bootstrap"></a>
</h2>
<p>The bootstrap can help evaluate uncertainty for more complex
statistics, and it’s a good option for our random forest analysis. In
each iteration, we randomly subsample timepoints from the original
experiment and compute a list of estimates, specified by the list
<code>funs</code> below. The output concatenates output across all
bootstrap iterations.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">funs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>direct <span class="op">=</span> <span class="va">direct_effect</span>, indirect <span class="op">=</span> <span class="va">indirect_overall</span><span class="op">)</span></span>
<span><span class="co"># inference &lt;- bootstrap(model, exper_rela, funs, B = 1e3)</span></span>
<span><span class="va">inference</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">url</a></span><span class="op">(</span><span class="st">"https://go.wisc.edu/ba3e87"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can now visualize the bootstrap confidence intervals associated
with the estimated effects. The largest interval corresponds to a 90%
bootstrap confidence interval. The inner interval covers the median +/-
one-third of the bootstrap distribution’s mass. Some associations
certainly seem worth following up on, though more data will be needed
for validation.</p>
<p>Notice that the direct effects seem generally stronger than indirect
effects. Even with a flexible random forest model, it seems that changes
in diet and sleep alone are not enough to explain the changes in
microbiome composition seen in this study. This suggests that mechanisms
related to the gut-brain axis may be at play, lying behind the observed
direct effects.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">inference</span><span class="op">$</span><span class="va">indirect</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_slabinterval.html" class="external-link">stat_slabinterval</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">indirect_effect</span>, <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">outcome</span>, <span class="va">indirect_effect</span>, <span class="va">median</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.66</span>, <span class="fl">.95</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Indirect Effects"</span>, y <span class="op">=</span> <span class="st">"Taxon"</span>, x <span class="op">=</span> <span class="st">"Effect (Rel. Abund Scale)"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">inference</span><span class="op">$</span><span class="va">direct</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_slabinterval.html" class="external-link">stat_slabinterval</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">direct_effect</span>, <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">outcome</span>, <span class="va">direct_effect</span>, <span class="va">median</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.66</span>, <span class="fl">.95</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Direct Effects"</span>, y <span class="op">=</span> <span class="st">"Taxon"</span>, x <span class="op">=</span> <span class="st">"Effect (Rel. Abund Scale)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></span></code></pre></div>
<p><img src="mindfulness_files/figure-html/rf_bootstrap_figures-1.png" width="600" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; R version 4.4.1 Patched (2024-08-21 r87049)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sonoma 14.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: America/Chicago</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] multimedia_0.2.0  tidyselect_1.2.1  ranger_0.16.0     glmnetUtils_1.1.9</span></span>
<span><span class="co">#&gt;  [5] brms_2.21.0       Rcpp_1.0.13       lubridate_1.9.3   forcats_1.0.0    </span></span>
<span><span class="co">#&gt;  [9] stringr_1.5.1     dplyr_1.1.4       purrr_1.0.2       readr_2.1.5      </span></span>
<span><span class="co">#&gt; [13] tidyr_1.3.1       tibble_3.2.1      tidyverse_2.0.0   phyloseq_1.49.0  </span></span>
<span><span class="co">#&gt; [17] ggrepel_0.9.5     ggdist_3.3.2      ggplot2_3.5.1    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] tensorA_0.36.2.1            jsonlite_1.8.8             </span></span>
<span><span class="co">#&gt;   [3] shape_1.4.6.1               magrittr_2.0.3             </span></span>
<span><span class="co">#&gt;   [5] TH.data_1.1-2               estimability_1.5.1         </span></span>
<span><span class="co">#&gt;   [7] farver_2.1.2                rmarkdown_2.28             </span></span>
<span><span class="co">#&gt;   [9] fs_1.6.4                    zlibbioc_1.51.1            </span></span>
<span><span class="co">#&gt;  [11] ragg_1.3.2                  vctrs_0.6.5                </span></span>
<span><span class="co">#&gt;  [13] multtest_2.61.0             htmltools_0.5.8.1          </span></span>
<span><span class="co">#&gt;  [15] S4Arrays_1.5.7              progress_1.2.3             </span></span>
<span><span class="co">#&gt;  [17] distributional_0.4.0        curl_5.2.2                 </span></span>
<span><span class="co">#&gt;  [19] Rhdf5lib_1.27.0             SparseArray_1.5.31         </span></span>
<span><span class="co">#&gt;  [21] rhdf5_2.49.0                sass_0.4.9                 </span></span>
<span><span class="co">#&gt;  [23] StanHeaders_2.32.10         bslib_0.8.0                </span></span>
<span><span class="co">#&gt;  [25] htmlwidgets_1.6.4           desc_1.4.3                 </span></span>
<span><span class="co">#&gt;  [27] plyr_1.8.9                  sandwich_3.1-0             </span></span>
<span><span class="co">#&gt;  [29] emmeans_1.10.4              zoo_1.8-12                 </span></span>
<span><span class="co">#&gt;  [31] cachem_1.1.0                igraph_2.0.3               </span></span>
<span><span class="co">#&gt;  [33] lifecycle_1.0.4             iterators_1.0.14           </span></span>
<span><span class="co">#&gt;  [35] pkgconfig_2.0.3             Matrix_1.7-0               </span></span>
<span><span class="co">#&gt;  [37] R6_2.5.1                    fastmap_1.2.0              </span></span>
<span><span class="co">#&gt;  [39] GenomeInfoDbData_1.2.12     MatrixGenerics_1.17.0      </span></span>
<span><span class="co">#&gt;  [41] digest_0.6.37               colorspace_2.1-1           </span></span>
<span><span class="co">#&gt;  [43] patchwork_1.2.0             S4Vectors_0.43.2           </span></span>
<span><span class="co">#&gt;  [45] textshaping_0.4.0           miniLNM_0.1.0              </span></span>
<span><span class="co">#&gt;  [47] GenomicRanges_1.57.1        vegan_2.6-8                </span></span>
<span><span class="co">#&gt;  [49] labeling_0.4.3              timechange_0.3.0           </span></span>
<span><span class="co">#&gt;  [51] fansi_1.0.6                 httr_1.4.7                 </span></span>
<span><span class="co">#&gt;  [53] abind_1.4-5                 mgcv_1.9-1                 </span></span>
<span><span class="co">#&gt;  [55] compiler_4.4.1              withr_3.0.1                </span></span>
<span><span class="co">#&gt;  [57] backports_1.5.0             inline_0.3.19              </span></span>
<span><span class="co">#&gt;  [59] highr_0.11                  QuickJSR_1.3.1             </span></span>
<span><span class="co">#&gt;  [61] pkgbuild_1.4.4              MASS_7.3-61                </span></span>
<span><span class="co">#&gt;  [63] DelayedArray_0.31.11        biomformat_1.33.0          </span></span>
<span><span class="co">#&gt;  [65] loo_2.8.0                   permute_0.9-7              </span></span>
<span><span class="co">#&gt;  [67] tools_4.4.1                 ape_5.8                    </span></span>
<span><span class="co">#&gt;  [69] glue_1.7.0                  nlme_3.1-166               </span></span>
<span><span class="co">#&gt;  [71] rhdf5filters_1.17.0         grid_4.4.1                 </span></span>
<span><span class="co">#&gt;  [73] checkmate_2.3.2             cluster_2.1.6              </span></span>
<span><span class="co">#&gt;  [75] reshape2_1.4.4              ade4_1.7-22                </span></span>
<span><span class="co">#&gt;  [77] generics_0.1.3              operator.tools_1.6.3       </span></span>
<span><span class="co">#&gt;  [79] gtable_0.3.5                tzdb_0.4.0                 </span></span>
<span><span class="co">#&gt;  [81] formula.tools_1.7.1         data.table_1.16.0          </span></span>
<span><span class="co">#&gt;  [83] hms_1.1.3                   tidygraph_1.3.1            </span></span>
<span><span class="co">#&gt;  [85] utf8_1.2.4                  XVector_0.45.0             </span></span>
<span><span class="co">#&gt;  [87] BiocGenerics_0.51.1         foreach_1.5.2              </span></span>
<span><span class="co">#&gt;  [89] pillar_1.9.0                posterior_1.6.0            </span></span>
<span><span class="co">#&gt;  [91] splines_4.4.1               lattice_0.22-6             </span></span>
<span><span class="co">#&gt;  [93] survival_3.7-0              Biostrings_2.73.1          </span></span>
<span><span class="co">#&gt;  [95] knitr_1.48                  gridExtra_2.3              </span></span>
<span><span class="co">#&gt;  [97] V8_5.0.0                    IRanges_2.39.2             </span></span>
<span><span class="co">#&gt;  [99] SummarizedExperiment_1.35.1 stats4_4.4.1               </span></span>
<span><span class="co">#&gt; [101] xfun_0.47                   bridgesampling_1.1-2       </span></span>
<span><span class="co">#&gt; [103] Biobase_2.65.1              matrixStats_1.4.0          </span></span>
<span><span class="co">#&gt; [105] rstan_2.32.6                stringi_1.8.4              </span></span>
<span><span class="co">#&gt; [107] UCSC.utils_1.1.0            yaml_2.3.10                </span></span>
<span><span class="co">#&gt; [109] evaluate_0.24.0             codetools_0.2-20           </span></span>
<span><span class="co">#&gt; [111] cli_3.6.3                   RcppParallel_5.1.9         </span></span>
<span><span class="co">#&gt; [113] xtable_1.8-4                systemfonts_1.1.0          </span></span>
<span><span class="co">#&gt; [115] munsell_0.5.1               jquerylib_0.1.4            </span></span>
<span><span class="co">#&gt; [117] GenomeInfoDb_1.41.1         coda_0.19-4.1              </span></span>
<span><span class="co">#&gt; [119] parallel_4.4.1              rstantools_2.4.0           </span></span>
<span><span class="co">#&gt; [121] pkgdown_2.1.0               prettyunits_1.2.0          </span></span>
<span><span class="co">#&gt; [123] bayesplot_1.11.1            Brobdingnag_1.2-9          </span></span>
<span><span class="co">#&gt; [125] glmnet_4.1-8                mvtnorm_1.3-1              </span></span>
<span><span class="co">#&gt; [127] scales_1.3.0                crayon_1.5.3               </span></span>
<span><span class="co">#&gt; [129] rlang_1.1.4                 multcomp_1.4-26</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kris Sankaran, Hanying Jiang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
